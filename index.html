
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>qimage2ndarray &#8212; qimage2ndarray 1.9.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">qimage2ndarray 1.9.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">qimage2ndarray</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="qimage2ndarray">
<h1>qimage2ndarray<a class="headerlink" href="#qimage2ndarray" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<p>qimage2ndarray is a small python package for quickly converting
between <a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImages</a> and <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html">numpy.ndarrays</a> (in both directions).  These are
very common tasks when programming e.g. scientific visualizations in
Python using <a class="reference external" href="http://www.riverbankcomputing.co.uk/software/pyqt/">PyQt4</a> as the GUI library.</p>
<p>Similar code was found in Qwt and floating around on mailing lists,
but qimage2ndarray has the following unique feature set:</p>
<ul>
<li><p>Supports conversion of scalar and RGB data, with arbitrary dtypes
and memory layout, with and without alpha channels, into QImages
(e.g. for display or saving using Qt).</p></li>
<li><p>qimage2ndarray makes it possible to create <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html">ndarrays</a> that are
<em>views</em> into a given <a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a>’s memory.</p>
<p>This allows for very efficient data handling and makes it possible
to modify Qt image data in-place (e.g. for brightness/gamma or alpha
mask modifications).</p>
</li>
<li><p>qimage2ndarray is stable and unit-tested:</p>
<ul class="simple">
<li><p>proper reference counting even with views (<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.base.html">ndarray.base</a> points to
the underlying <a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a>)</p></li>
<li><p>handles non-standard widths and respects QImage’s 32-bit row
alignment</p></li>
<li><p>tested with Python 2 and Python 3, and various Qt wrappers</p></li>
</ul>
</li>
<li><p><a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/maskedarray.generic.html">Masked arrays</a> are also supported and are converted into QImages
with transparent pixels.</p></li>
<li><p>Supports <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html">recarrays</a> (and comes with an appropriate dtype) for
convenient access to RGB(A) channels (see <code class="xref py py-func docutils literal notranslate"><span class="pre">recarray_view()</span></code>).</p></li>
<li><p>Supports value scaling / normalization to 0..255 for convenient
display of arbitrary NumPy arrays.</p></li>
<li><p>Recent additions are convenient image loading / saving methods.</p></li>
</ul>
<p>qimage2ndarray works with both Python 2.x and Python 3.x on all major
platforms, and with different Python wrappers of Qt (PyQt4 and PyQt5,
PySide, PySide2 and PythonQt).  The package is open source,
<a class="reference external" href="http://www.opensource.org/licenses/bsd-license.php">BSD-licensed</a>, and the repository can be <a class="reference external" href="https://github.com/hmeine/qimage2ndarray">browsed online</a> or cloned
using <a class="reference external" href="http://git-scm.com">Git</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">hmeine</span><span class="o">/</span><span class="n">qimage2ndarray</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<section id="changelog">
<h2>Changelog<a class="headerlink" href="#changelog" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>Version 1.9.0:</dt><dd><ul class="simple">
<li><p>first support for 64bit pixel types</p></li>
<li><p>support PySide6</p></li>
<li><p>code cleanups</p></li>
</ul>
</dd>
<dt>Version 1.8.3:</dt><dd><ul class="simple">
<li><p>fix normalization potentially modifying input array</p></li>
</ul>
</dd>
<dt>Version 1.8.2:</dt><dd><ul class="simple">
<li><p>normalize boolean arrays to 0/255 by default</p></li>
</ul>
</dd>
<dt>Version 1.8.1:</dt><dd><ul class="simple">
<li><p>support normalization of boolean arrays</p></li>
</ul>
</dd>
<dt>Version 1.8:</dt><dd><ul class="simple">
<li><p>improve exception when calling <cite>imread</cite> on non-existing file</p></li>
<li><p>improved pure-python implementation working with PythonQt as well</p></li>
</ul>
</dd>
<dt>Version 1.7:</dt><dd><ul class="simple">
<li><p>add support for PySide2</p></li>
<li><p>changed default driver from PyQt4 to PyQt5</p></li>
</ul>
</dd>
<dt>Version 1.6:</dt><dd><ul class="simple">
<li><p>finally, also support PySide on Python 3 (closing last known issue)</p></li>
</ul>
</dd>
<dt>Version 1.5.1:</dt><dd><ul class="simple">
<li><p>small installation and documentation fixes</p></li>
</ul>
</dd>
<dt>Version 1.5:</dt><dd><ul class="simple">
<li><p>PyQt5 support</p></li>
</ul>
</dd>
<dt>Version 1.4:</dt><dd><ul class="simple">
<li><p><em>pure python</em> version of qimage2ndarray</p></li>
<li><p>PySide support (Python 2 only yet)</p></li>
<li><p>added <code class="xref py py-func docutils literal notranslate"><span class="pre">imsave()</span></code></p></li>
</ul>
</dd>
<dt>Version 1.3.1:</dt><dd><ul class="simple">
<li><p>restored compatibility with NumPy 1.6 (lost in 1.2)</p></li>
</ul>
</dd>
<dt>Version 1.3:</dt><dd><ul class="simple">
<li><p>added <code class="xref py py-func docutils literal notranslate"><span class="pre">imread()</span></code></p></li>
<li><p>added implicit loading in view functions</p></li>
</ul>
</dd>
<dt>Version 1.2:</dt><dd><ul class="simple">
<li><p>support Python 3.x (in addition to Python 2.x, same codebase)</p></li>
<li><p>adapted to NumPy 1.7 API</p></li>
<li><p>move documentation away from uni-hamburg.de, too</p></li>
</ul>
</dd>
<dt>Version 1.1:</dt><dd><ul class="simple">
<li><p>gracefully handle empty normalization range</p></li>
<li><p>improved compilation support (on Windows and OS X)</p></li>
<li><p>small optimizations</p></li>
<li><p>support alternative Qt bindings (PythonQt, used by MeVisLab)</p></li>
<li><p>update URLs/email to move away from uni-hamburg.de</p></li>
</ul>
</dd>
<dt>Version 1.0:</dt><dd><ul class="simple">
<li><p>Let array2qimage support 2 channels (gray + alpha)</p></li>
<li><p>Fixed installation on OS X (where Qt libs come as “Frameworks”)</p></li>
</ul>
</dd>
<dt>Version 0.2:</dt><dd><ul class="simple">
<li><p>Fixed endianness issues (tested on PowerPC arch)</p></li>
<li><p>Simplified installation on Windows (e.g. with Qt DLLs bundled with PyQt)</p></li>
</ul>
</dd>
<dt>Version 0.1:</dt><dd><ul class="simple">
<li><p>Initial Relase</p></li>
</ul>
</dd>
</dl>
</section>
<section id="module-qimage2ndarray">
<span id="usage"></span><h2>Usage<a class="headerlink" href="#module-qimage2ndarray" title="Permalink to this headline">¶</a></h2>
<p>There are two opposite directions of conversion, discussed in the next
subsections:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#converting-qimages-into-numpy-ndarrays">Converting QImages into numpy.ndarrays</a>.</p></li>
<li><p><a class="reference internal" href="#converting-ndarrays-into-qimages">Converting ndarrays into QImages</a>.</p></li>
</ol>
<p>The first task is supported by a family of functions that create
<em>views</em> into the corresponding <a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a> memory, while the second task
will always copy the image data (usually converting it into the
appropriate type or value range).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The reason for this is that <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html">ndarrays</a> are much more flexible than
<a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImages</a>, and while it is possible – even using pure python – to
create QImages that are views into an ndarray’s memory, this will
only work if the latter fulfills certain strict requirements
w.r.t. dtype, strides / memory layout etc.  Thus, you’d need
functions that set up a properly convertible ndarray, which makes
this less convenient.  Moreover, it is then a logical next step to
let QImage set up and manage the memory and instead create ndarray
views.</p>
</aside>
<section id="converting-qimages-into-numpy-ndarrays">
<h3>Converting QImages into numpy.ndarrays<a class="headerlink" href="#converting-qimages-into-numpy-ndarrays" title="Permalink to this headline">¶</a></h3>
<p>QImages can be viewed as <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html">recarrays</a> using
<a class="reference internal" href="#qimage2ndarray.recarray_view" title="qimage2ndarray.recarray_view"><code class="xref py py-func docutils literal notranslate"><span class="pre">recarray_view()</span></code></a>, as uint8-valued array using <a class="reference internal" href="#qimage2ndarray.rgb_view" title="qimage2ndarray.rgb_view"><code class="xref py py-func docutils literal notranslate"><span class="pre">rgb_view()</span></code></a>,
<a class="reference internal" href="#qimage2ndarray.alpha_view" title="qimage2ndarray.alpha_view"><code class="xref py py-func docutils literal notranslate"><span class="pre">alpha_view()</span></code></a>, or just <a class="reference internal" href="#qimage2ndarray.byte_view" title="qimage2ndarray.byte_view"><code class="xref py py-func docutils literal notranslate"><span class="pre">byte_view()</span></code></a>, or as raw 2D array
using <a class="reference internal" href="#qimage2ndarray.raw_view" title="qimage2ndarray.raw_view"><code class="xref py py-func docutils literal notranslate"><span class="pre">raw_view()</span></code></a>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="qimage2ndarray.recarray_view">
<span class="sig-name descname"><span class="pre">recarray_view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qimage</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qimage2ndarray.recarray_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html">recarray</a> view of a given 32-bit color <a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a>’s
memory.</p>
<p>The result is a 2D array with a complex record dtype, offering the
named fields ‘r’,’g’,’b’, and ‘a’ and corresponding long names.
Thus, each color components can be accessed either via string
indexing or via attribute lookup (through <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html">numpy.recarray</a>):</p>
<p>For your convenience, <cite>qimage</cite> may also be a filename, see
<a class="reference internal" href="#loading-and-saving-images">Loading and Saving Images</a> in the documentation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">PyQt4.QtGui</span> <span class="kn">import</span> <span class="n">QImage</span><span class="p">,</span> <span class="n">qRgb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qimg</span> <span class="o">=</span> <span class="n">QImage</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="n">QImage</span><span class="o">.</span><span class="n">Format_ARGB32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qimg</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">qRgb</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">56</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">qimage2ndarray</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">qimage2ndarray</span><span class="o">.</span><span class="n">recarray_view</span><span class="p">(</span><span class="n">qimg</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">red</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">red</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pixel</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pixel</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">g</span> <span class="o">==</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">alpha</span> <span class="o">==</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qimage</strong> (<a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a> with 32-bit pixel type) – image whose memory shall be accessed via NumPy</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html">numpy.ndarray</a> with shape (height, width)
and dtype <a class="reference internal" href="#qimage2ndarray.bgra_dtype" title="qimage2ndarray.bgra_dtype"><code class="xref py py-data docutils literal notranslate"><span class="pre">bgra_dtype</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="qimage2ndarray.bgra_dtype">
<span class="sig-name descname"><span class="pre">bgra_dtype</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">dtype([(('blue',</span> <span class="pre">'b'),</span> <span class="pre">'u1'),</span> <span class="pre">(('green',</span> <span class="pre">'g'),</span> <span class="pre">'u1'),</span> <span class="pre">(('red',</span> <span class="pre">'r'),</span> <span class="pre">'u1'),</span> <span class="pre">(('alpha',</span> <span class="pre">'a'),</span> <span class="pre">'u1')])</span></em><a class="headerlink" href="#qimage2ndarray.bgra_dtype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qimage2ndarray.rgb_view">
<span class="sig-name descname"><span class="pre">rgb_view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qimage</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qimage2ndarray.rgb_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns RGB view of a given 32-bit color <a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a>’s memory.
Similarly to byte_view(), the result is a 3D numpy.uint8 array,
but reduced to the rgb dimensions (without alpha), and reordered
(using negative strides in the last dimension) to have the usual
[R,G,B] order.  The image must have 32 bit pixel size, i.e. be
RGB32, ARGB32, or ARGB32_Premultiplied.  (Note that in the latter
case, the values are of course premultiplied with alpha.)</p>
<p>The order of channels in the last axis depends on the <cite>byteorder</cite>,
which defaults to ‘big’, i.e. RGB order.  You may set the argument
<cite>byteorder</cite> to ‘little’ to get BGR, or use None which means
sys.byteorder here, i.e. return native order for the machine the
code is running on.</p>
<p>For your convenience, <cite>qimage</cite> may also be a filename, see
<a class="reference internal" href="#loading-and-saving-images">Loading and Saving Images</a> in the documentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qimage</strong> (<a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a> with 32-bit pixel type) – image whose memory shall be accessed via NumPy</p></li>
<li><p><strong>byteorder</strong> – specify order of channels in last axis</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html">numpy.ndarray</a> with shape (height, width, 3) and dtype uint8</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qimage2ndarray.alpha_view">
<span class="sig-name descname"><span class="pre">alpha_view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qimage</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qimage2ndarray.alpha_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns alpha view of a given 32-bit color <a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a>’s memory.
The result is a 2D numpy.uint8 array, equivalent to
byte_view(qimage)[…,3].  The image must have 32 bit pixel size,
i.e. be RGB32, ARGB32, or ARGB32_Premultiplied.  Note that it is
not enforced that the given qimage has a format that actually
<em>uses</em> the alpha channel – for Format_RGB32, the alpha channel
usually contains 255 everywhere.</p>
<p>For your convenience, <cite>qimage</cite> may also be a filename, see
<a class="reference internal" href="#loading-and-saving-images">Loading and Saving Images</a> in the documentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qimage</strong> (<a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a> with 32-bit pixel type) – image whose memory shall be accessed via NumPy</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html">numpy.ndarray</a> with shape (height, width) and dtype uint8</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qimage2ndarray.byte_view">
<span class="sig-name descname"><span class="pre">byte_view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qimage</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qimage2ndarray.byte_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns raw 3D view of the given <a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a>’s memory.  This will
always be a 3-dimensional numpy.ndarray with dtype numpy.uint8.</p>
<p>Note that for 32-bit images, the last dimension will be in the
[B,G,R,A] order (if little endian) due to <a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a>’s memory layout
(the alpha channel will be present for Format_RGB32 images, too).</p>
<p>For 8-bit (indexed) images, the array will still be 3-dimensional,
i.e. shape will be (height, width, 1).</p>
<p>The order of channels in the last axis depends on the <cite>byteorder</cite>,
which defaults to ‘little’, i.e. BGRA order.  You may set the
argument <cite>byteorder</cite> to ‘big’ to get ARGB, or use None which means
sys.byteorder here, i.e. return native order for the machine the
code is running on.</p>
<p>For your convenience, <cite>qimage</cite> may also be a filename, see
<a class="reference internal" href="#loading-and-saving-images">Loading and Saving Images</a> in the documentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qimage</strong> (<a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a>) – image whose memory shall be accessed via NumPy</p></li>
<li><p><strong>byteorder</strong> – specify order of channels in last axis</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html">numpy.ndarray</a> with shape (height, width, 1 or 4) and dtype uint8</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qimage2ndarray.raw_view">
<span class="sig-name descname"><span class="pre">raw_view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qimage</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qimage2ndarray.raw_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns raw 2D view of the given <a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a>’s memory.  The result
will be a 2-dimensional numpy.ndarray with an appropriately sized
integral dtype.  (This function is not intented to be used
directly, but used internally by the other – more convenient –
view creation functions.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qimage</strong> (<a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a>) – image whose memory shall be accessed via NumPy</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html">numpy.ndarray</a> with shape (height, width)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="converting-ndarrays-into-qimages">
<h3>Converting ndarrays into QImages<a class="headerlink" href="#converting-ndarrays-into-qimages" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="qimage2ndarray.array2qimage">
<span class="sig-name descname"><span class="pre">array2qimage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#qimage2ndarray.array2qimage" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a 2D or 3D numpy array into a 32-bit <a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a>.  The
first dimension represents the vertical image axis; the optional
third dimension is supposed to contain 1-4 channels:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>#channels</p></th>
<th class="head"><p>interpretation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>scalar/gray</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>scalar/gray + alpha</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>RGB</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>RGB + alpha</p></td>
</tr>
</tbody>
</table>
<p>Scalar data will be converted into corresponding gray RGB triples;
if you want to convert to an (indexed) 8-bit image instead, use
<cite>gray2qimage</cite> (which cannot support an alpha channel though).</p>
<p>The parameter <cite>normalize</cite> can be used to normalize an image’s
value range to 0..255:</p>
<dl class="simple">
<dt><cite>normalize</cite> = (nmin, nmax):</dt><dd><p>scale &amp; clip image values from nmin..nmax to 0..255</p>
</dd>
<dt><cite>normalize</cite> = nmax:</dt><dd><p>lets nmin default to zero, i.e. scale &amp; clip the range 0..nmax
to 0..255</p>
</dd>
<dt><cite>normalize</cite> = True:</dt><dd><p>scale image values to 0..255 (same as passing (gray.min(),
gray.max()), except for boolean arrays, where False/True
are mapped to 0/255)</p>
</dd>
</dl>
<p>If <cite>array</cite> contains masked values, the corresponding pixels will
be transparent in the result.  Thus, the result will be of
QImage.Format_ARGB32 if the input already contains an alpha
channel (i.e. has shape (H,W,4)) or if there are masked pixels,
and QImage.Format_RGB32 otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (2D or 3D <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html">numpy.ndarray</a> or <a class="reference external" href="maskedarrays">numpy.ma.array</a>) – image data which should be converted (copied) into a <a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a></p></li>
<li><p><strong>normalize</strong> (<em>bool</em><em>, </em><em>scalar</em><em>, or </em><em>pair</em>) – normalization parameter (see above, default: no value changing)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a> with RGB32 or ARGB32 format</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qimage2ndarray.gray2qimage">
<span class="sig-name descname"><span class="pre">gray2qimage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gray</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#qimage2ndarray.gray2qimage" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the 2D numpy array <cite>gray</cite> into a 8-bit, indexed <a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a>
with a gray colormap.  The first dimension represents the vertical
image axis.</p>
<p>The parameter <cite>normalize</cite> can be used to normalize an image’s
value range to 0..255:</p>
<dl class="simple">
<dt><cite>normalize</cite> = (nmin, nmax):</dt><dd><p>scale &amp; clip image values from nmin..nmax to 0..255</p>
</dd>
<dt><cite>normalize</cite> = nmax:</dt><dd><p>lets nmin default to zero, i.e. scale &amp; clip the range 0..nmax
to 0..255</p>
</dd>
<dt><cite>normalize</cite> = True:</dt><dd><p>scale image values to 0..255 (same as passing (gray.min(),
gray.max()), except for boolean arrays, where False/True
are mapped to 0/255)</p>
</dd>
</dl>
<p>If the source array <cite>gray</cite> contains masked values, the result will
have only 255 shades of gray, and one color map entry will be used
to make the corresponding pixels transparent.</p>
<p>A full alpha channel cannot be supported with indexed images;
instead, use <cite>array2qimage</cite> to convert into a 32-bit QImage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gray</strong> – image data which should be converted (copied) into a <a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a></p></li>
<li><p><strong>normalize</strong> (<em>bool</em><em>, </em><em>scalar</em><em>, or </em><em>pair</em>) – normalization parameter (see above, default: no value changing)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a> with RGB32 or ARGB32 format</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="loading-and-saving-images">
<h3>Loading and Saving Images<a class="headerlink" href="#loading-and-saving-images" title="Permalink to this headline">¶</a></h3>
<p>There are two ways to read images from disk directly into <cite>ndarrays</cite>:</p>
<ol class="arabic simple">
<li><p>The <a class="reference internal" href="#qimage2ndarray.imread" title="qimage2ndarray.imread"><code class="xref py py-func docutils literal notranslate"><span class="pre">imread()</span></code></a> function mimicks existing API in other
libraries, returning an ndarray whose dimensionality and shape
depends on whether the image is a color or grayscale image.</p></li>
<li><p>Also, the view functions (all five of them) can be passed a
filename instead of a qimage.  This can be more useful than
<a class="reference internal" href="#qimage2ndarray.imread" title="qimage2ndarray.imread"><code class="xref py py-func docutils literal notranslate"><span class="pre">imread()</span></code></a>, e.g. in case you want to get a <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html">recarray</a>
(<a class="reference internal" href="#qimage2ndarray.recarray_view" title="qimage2ndarray.recarray_view"><code class="xref py py-func docutils literal notranslate"><span class="pre">recarray_view()</span></code></a>), just the alpha channel
(<a class="reference internal" href="#qimage2ndarray.alpha_view" title="qimage2ndarray.alpha_view"><code class="xref py py-func docutils literal notranslate"><span class="pre">alpha_view()</span></code></a>), or the original ARGB image data
(<a class="reference internal" href="#qimage2ndarray.byte_view" title="qimage2ndarray.byte_view"><code class="xref py py-func docutils literal notranslate"><span class="pre">byte_view()</span></code></a>).</p></li>
</ol>
<dl class="py function">
<dt class="sig sig-object py" id="qimage2ndarray.imread">
<span class="sig-name descname"><span class="pre">imread</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qimage2ndarray.imread" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function that uses the <a class="reference external" href="http://qt-project.org/doc/qt-4.8/qimage.html">QImage</a> constructor to read an
image from the given file and return an <cite>rgb_view</cite> of the result.
This is intentionally similar to scipy.ndimage.imread (which uses
PIL), scipy.misc.imread, or matplotlib.pyplot.imread (using PIL
for non-PNGs).</p>
<p>For grayscale images, return 2D array (even if it comes from a 32-bit
representation; this is a consequence of the QImage API).</p>
<p>For images with an alpha channel, the resulting number of channels
will be 2 (grayscale+alpha) or 4 (RGB+alpha).  Alternatively, one may
pass <cite>masked = True</cite> in order to get <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/maskedarray.generic.html">masked arrays</a> back.
Note that only fully transparent pixels are masked
(and that masked arrays only support binary masks).  The value of
<cite>masked</cite> is ignored when the loaded image has no alpha channel
(i.e., one would not get a masked array in that case).</p>
<p>This function has been added in version 1.3.</p>
</dd></dl>

<p>Finally, there is also a tiny wrapper around <a class="reference internal" href="#qimage2ndarray.array2qimage" title="qimage2ndarray.array2qimage"><code class="xref py py-func docutils literal notranslate"><span class="pre">array2qimage()</span></code></a> and
<cite>QImage.save()</cite> for saving images to disk:</p>
<dl class="py function">
<dt class="sig sig-object py" id="qimage2ndarray.imsave">
<span class="sig-name descname"><span class="pre">imsave</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#qimage2ndarray.imsave" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function that uses QImage.save to save an image to the
given file.  This is intentionally similar to scipy.misc.imsave.
However, it supports different optional arguments:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalize</strong> – see <a class="reference internal" href="#qimage2ndarray.array2qimage" title="qimage2ndarray.array2qimage"><code class="xref py py-func docutils literal notranslate"><span class="pre">array2qimage()</span></code></a> (which is used internally)</p></li>
<li><p><strong>format</strong> – image filetype (e.g. ‘PNG’),  (default: check filename’s suffix)</p></li>
<li><p><strong>quality</strong> – see QImage.save (0 = small .. 100 = uncompressed,
-1 = default compression)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>boolean success, see QImage.save</p>
</dd>
</dl>
<p>This function has been added in version 1.4.</p>
</dd></dl>

</section>
</section>
<section id="indices-and-tables">
<h2>Indices and Tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="#">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">qimage2ndarray</a><ul>
<li><a class="reference internal" href="#changelog">Changelog</a></li>
<li><a class="reference internal" href="#module-qimage2ndarray">Usage</a><ul>
<li><a class="reference internal" href="#converting-qimages-into-numpy-ndarrays">Converting QImages into numpy.ndarrays</a></li>
<li><a class="reference internal" href="#converting-ndarrays-into-qimages">Converting ndarrays into QImages</a></li>
<li><a class="reference internal" href="#loading-and-saving-images">Loading and Saving Images</a></li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and Tables</a></li>
</ul>
</li>
</ul>

  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">qimage2ndarray 1.9.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">qimage2ndarray</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2022, Hans Meine.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
  </body>
</html>